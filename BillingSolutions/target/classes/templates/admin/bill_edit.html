<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org">
<head>
	<meta charset="UTF-8">
	<title>Edit Bill (Admin)</title>
</head>
<body>
	<h2>Edit Bill</h2>
	<div>
		<p><strong>Customer:</strong> <span th:text="${bill.customerNameSnapshot}"></span></p>
		<p><strong>Previous Due:</strong> <span th:text="${bill.previousDue}"></span></p>
		<p><strong>Profit (Total - Cost):</strong> <span th:text="${bill.total - bill.totalCostBasis}"></span></p>
	</div>
	<form th:action="@{'/admin/bills/' + ${bill.id}}" method="post">
		<table border="1">
			<thead>
				<tr>
					<th>Product</th><th>Unit Price</th><th>Qty (pcs)</th><th>Discount %</th><th>Line Total</th>
				</tr>
			</thead>
			<tbody>
				<tr th:each="i,iter : ${bill.items}">
					<td th:text="${i.product.name}"></td>
					<td th:text="${i.unitPriceSnapshot}"></td>
					<td th:text="${i.totalPieces}"></td>
					<td>
						<input type="hidden" th:name="${'items[' + iter.index + '].itemId'}" th:value="${i.id}" />
						<input th:name="${'items[' + iter.index + '].discountPercent'}" type="number" step="0.01" th:value="${i.discountPercent}" />
					</td>
					<td th:text="${i.lineTotal}"></td>
				</tr>
			</tbody>
		</table>
		<div>
			<label>Payment Against Previous Due</label>
			<input name="paymentAgainstPreviousDue" type="number" step="0.01" th:value="${bill.paymentAgainstPreviousDue}" />
		</div>
		<div>
			<button type="submit">Save</button>
		</div>
	</form>
</body>
</html> 